

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Compute Spatially Variable Genes With SPARK &mdash; Giotto 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx-toolbox-code.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/sphinx-toolbox.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_edits.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_toolbox_installation.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_edits.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/design-style.d53ab927f7bad3eaa42da95908504b10.min.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/sphinx_toolbox_installation.js"></script>
        <script src="../../_static/design-tabs.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create Simulated Spatial Pattern" href="simulateOneGenePatternGiottoObject.html" />
    <link rel="prev" title="Compute Spatially Variable Genes With Trendsceek" href="trendSceek.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/GiottoLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">.. Home</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gettingstarted.html">Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#giotto-handing-functions">Giotto Handing Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#import-raw-data">Import Raw Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#adding-images">Adding Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#dimension-reduction">Dimension Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#clustering">Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#marker-genes">Marker Genes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#auxiliary-visualizations">Auxiliary Visualizations</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../documentation.html#spatial">Spatial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../documentation.html#enrichment-deconvolution">Enrichment &amp; Deconvolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../documentation.html#spatial-network-or-grid">Spatial Network Or Grid</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../documentation.html#spatial-genes">Spatial Genes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../documentation.html#spatial-gene-simulation">Spatial Gene Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../documentation.html#spatial-co-expression-patterns-modules">Spatial Co-Expression Patterns/Modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#hidden-markov-random-field-hmrf">Hidden Markov Random Field (HMRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#d-visualization">2D Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#id1">3D Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#in-silico-cross-sections">In Silico Cross Sections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#cell-neighborhood">Cell Neighborhood</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#export-from-giotto-analyzer-to-viewer">Export From Giotto Analyzer To Viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#interoperability">Interoperability</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l2"><a class="reference external" href="http://spatial.rc.fas.harvard.edu/giotto-viewer/">Giotto Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tipsandtricks.html">HowTos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trygiotto.html">Try Giotto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../errorsfaqsandtips.html">Common Errors and Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../github_issues.html">Report a Bug</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#example-functionalities">Example Functionalities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#giotto-handing-functions">Giotto Handing Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#import-raw-data">Import Raw Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#adding-images">Adding Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#dimension-reduction">Dimension Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#clustering">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#marker-genes">Marker Genes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#auxiliary-visualizations">Auxiliary Visualizations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../documentation.html#spatial">Spatial</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#enrichment-deconvolution">Enrichment &amp; Deconvolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#spatial-network-or-grid">Spatial Network Or Grid</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../documentation.html#spatial-genes">Spatial Genes</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="binSpect.html">binSpect</a></li>
<li class="toctree-l4"><a class="reference internal" href="binSpectSingle.html">binSpectSingle</a></li>
<li class="toctree-l4"><a class="reference internal" href="binSpectMulti.html">binSpectMulti</a></li>
<li class="toctree-l4"><a class="reference internal" href="silhouetteRank.html">silhouetteRank</a></li>
<li class="toctree-l4"><a class="reference internal" href="spatialDE.html">spatialDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="spatialAEH.html">spatialAEH</a></li>
<li class="toctree-l4"><a class="reference internal" href="trendSceek.html">trendSceek</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">spark</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#spatial-gene-simulation">Spatial Gene Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation.html#spatial-co-expression-patterns-modules">Spatial Co-Expression Patterns/Modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#hidden-markov-random-field-hmrf">Hidden Markov Random Field (HMRF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#d-visualization">2D Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#id1">3D Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#in-silico-cross-sections">In Silico Cross Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#cell-neighborhood">Cell Neighborhood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#export-from-giotto-analyzer-to-viewer">Export From Giotto Analyzer To Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation.html#interoperability">Interoperability</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference external" href="http://spatial.rc.fas.harvard.edu/giotto-viewer/">Giotto Viewer</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tipsandtricks.html">HowTos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trygiotto.html">Try Giotto</a></li>
</ul>
<p class="caption"><span class="caption-text">Issues</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../errorsfaqsandtips.html">Common Errors and Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../github_issues.html">Report a Bug</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Giotto</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../documentation.html">Function Documentation</a> &raquo;</li>
        
      <li>Compute Spatially Variable Genes With SPARK</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/subsections/documentation_functions/spark.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compute-spatially-variable-genes-with-spark">
<span id="spark"></span><h1>Compute Spatially Variable Genes With SPARK<a class="headerlink" href="#compute-spatially-variable-genes-with-spark" title="Permalink to this headline">¶</a></h1>
<dl class="describe">
<dt>
<code class="sig-name descname">spark()</code></dt>
<dd></dd></dl>

<p><em>Compute spatially expressed genes with SPARK method.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">(</span>
    <span class="n">gobject</span><span class="p">,</span>
    <span class="n">percentage</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">min_count</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">expression_values</span> <span class="o">=</span> <span class="s2">&quot;raw&quot;</span><span class="p">,</span>
    <span class="n">num_core</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">covariates</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">,</span>
    <span class="n">return_object</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;data.table&quot;</span><span class="p">,</span> <span class="s2">&quot;spark&quot;</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>gobject</p></td>
<td><p>giotto object</p></td>
</tr>
<tr class="row-even"><td><p>percentage</p></td>
<td><p>The percentage of cells that are expressed for analysis</p></td>
</tr>
<tr class="row-odd"><td><p>min_count</p></td>
<td><p>minimum number of counts for a gene to be included</p></td>
</tr>
<tr class="row-even"><td><p>expression_values</p></td>
<td><p>type of values to use (raw by default)</p></td>
</tr>
<tr class="row-odd"><td><p>num_core</p></td>
<td><p>number of cores to use</p></td>
</tr>
<tr class="row-even"><td><p>covariates</p></td>
<td><p>The covariates in experiments, i.e. confounding factors/batch effect. Column name of giotto cell metadata.</p></td>
</tr>
<tr class="row-odd"><td><p>return_object</p></td>
<td><p>type of result to return (data.table or spark object)</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>Additional parameters to the <code class="docutils literal notranslate"><span class="pre">spark.vc</span></code> function</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="value">
<h2>Value<a class="headerlink" href="#value" title="Permalink to this headline">¶</a></h2>
<p>A data.table with SPARK spatial genes’ results or the SPARK object.</p>
<p><a class="reference external" href="https://github.com/xzhoulab/SPARK">More about SPARK</a></p>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<p>This function is a wrapper for the method implemented in the SPARK package:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>CreateSPARKObject</p></td>
<td><p>Creates a SPARK object from a Giotto object</p></td>
</tr>
<tr class="row-even"><td><p>spark.vc</p></td>
<td><p>Fits the count-based spatial model to estimate the parameters, see spark.vc for additional parameters</p></td>
</tr>
<tr class="row-odd"><td><p>spark.test</p></td>
<td><p>Tests multiple kernel matrices</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SPARK is a method perceived as an extension of SpatialDE. SPARK models count data directly and employs properly calibrated p-values.
Well-calibrated p-values allows this method to find more spatially variable genes at a given FDR cut-off.
This is sometimes an improvement over SpatialDE which may produce overly conservative p-values. SPARK models expression levels across spatial locations using generalized linear spatial model (GLSM).
It allows modeling the distribution of expression values through an overdispersed Poisson distribution (for count data) or Gaussian distribution (for normalized data).
Notably, to make sure that the algorithm can discover various spatial patterns, SPARK employs ten different spatial kernels, including five periodic kernels with different periodicity
parameters and five Gaussian kernels with different smoothness parameters.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="simulateOneGenePatternGiottoObject.html" class="btn btn-neutral float-right" title="Create Simulated Spatial Pattern" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="trendSceek.html" class="btn btn-neutral float-left" title="Compute Spatially Variable Genes With Trendsceek" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ruben Dries, Qian Zhu, Huipeng Li, Rui Dong, Guo-Cheng Yuan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>